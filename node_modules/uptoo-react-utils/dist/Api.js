!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("uptoo-react-utils",[],e):"object"==typeof exports?exports["uptoo-react-utils"]=e():t["uptoo-react-utils"]=e()}("undefined"!=typeof self?self:this,function(){return function(t){function e(o){if(n[o])return n[o].exports;var r=n[o]={i:o,l:!1,exports:{}};return t[o].call(r.exports,r,r.exports,e),r.l=!0,r.exports}var n={};return e.m=t,e.c=n,e.d=function(t,n,o){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:o})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=7)}([function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o={set:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:7,o=new Date,r="expires="+o.toUTCString();return null!==this.get(t)&&this.delete(t),o.setTime(o.getTime()+24*n*60*60*1e3),document.cookie=t+"="+e+";"+r+";path=/",null},delete:function(t){return document.cookie=t+"=; Path=/; Expires=Thu, 01 Jan 1970 00:00:01 GMT;",!0},get:function(t){var e="; "+document.cookie,n=e.split("; "+t+"=");return 2===n.length?n.pop().split(";").shift():null}};e.default=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a={API_DOMAIN:null,JWT_TOKEN:null,AUTHORIZED_USERS:[],STORE:null},i={get:function(t){return a[t]?a[t]:console.warn("[react-utils] : Configuration is not defined for : ",t)},set:function(t,e){a[t]=e},isSet:function(t){return"undefined"!==r(a[t])}};e.default=o({},i)},function(t,e){(function(e){t.exports=e}).call(e,{})},function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(){return d||(d=new l(s.default)),d}Object.defineProperty(e,"__esModule",{value:!0});var i=n(1),u=o(i),c=n(0),s=o(c),l=function t(e){var o=this;r(this,t),this.execute=function(t,e){var r=t,a=e,i=u.default.get("STORE"),c=o.StorageManager.get(u.default.get("JWT_TOKEN"));return"http"!==t.substring(0,4)&&("/"!==t.substring(0,1)&&(r="/"+t),r=""+u.default.get("API_DOMAIN")+t),void 0!==c&&c&&(a.headers.authorization=c),fetch(r,a).then(function(t){return 401===t.status&&(o.StorageManager.delete(u.default.get("JWT_TOKEN")),void 0!==i&&i.dispatch({type:"REDIRECT",payload:" /auth/login"})),t.json()}).then(function(t){if(t.error)throw Error(t.error);if(t.redirect&&void 0!==i&&i.dispatch({type:"REDIRECT",payload:t.redirect}),t.token){var e=t.token.split(".")[1];e=e.replace("-","+").replace("_","/");var r=window&&window.atob?window.atob:n(4).decode;if(e=JSON.parse(decodeURIComponent(escape(r(e)))),!u.default.get("AUTHORIZED_USERS").includes(e.type))throw Error("Votre compte ne permet pas d'accéder à cet espace");o.StorageManager.set(u.default.get("JWT_TOKEN"),t.token),void 0!==i&&i.dispatch({type:"AUTH_TOKEN",payload:t.token})}return t})},this.get=function(t){var e={method:"GET",headers:{"Access-Control-Request-Method":"GET"}};return o.execute(t,e)},this.post=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={method:"POST",body:JSON.stringify(e),headers:{"Access-Control-Request-Method":"POST","Content-Type":"application/json"}};return o.execute(t,n)},this.put=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={method:"PUT",body:JSON.stringify(e),headers:{"Access-Control-Request-Method":"PUT","Content-Type":"application/json"}};return o.execute(t,n)},this.delete=function(t){var e={method:"DELETE",headers:{"Access-Control-Request-Method":"DELETE"}};return o.execute(t,e)},this.StorageManager=e},d=null;e.default={Instance:l,get:a().get,post:a().post,put:a().put,delete:a().delete}},function(t,e,n){"use strict";(function(t,o){var r,a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(i){var u="object"==a(e)&&e,c="object"==a(t)&&t&&t.exports==u&&t,s="object"==(void 0===o?"undefined":a(o))&&o;s.global!==s&&s.window!==s||(i=s);var l=function(t){this.message=t};l.prototype=new Error,l.prototype.name="InvalidCharacterError";var d=function(t){throw new l(t)},f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",p=/[\t\n\f\r ]/g,y=function(t){t=String(t).replace(p,"");var e=t.length;e%4==0&&(t=t.replace(/==?$/,""),e=t.length),(e%4==1||/[^+a-zA-Z0-9\/]/.test(t))&&d("Invalid character: the string to be decoded is not correctly encoded.");for(var n,o,r=0,a="",i=-1;++i<e;)o=f.indexOf(t.charAt(i)),n=r%4?64*n+o:o,r++%4&&(a+=String.fromCharCode(255&n>>(-2*r&6)));return a},h=function(t){t=String(t),/[^\0-\xFF]/.test(t)&&d("The string to be encoded contains characters outside of the Latin1 range.");for(var e,n,o,r,a=t.length%3,i="",u=-1,c=t.length-a;++u<c;)e=t.charCodeAt(u)<<16,n=t.charCodeAt(++u)<<8,o=t.charCodeAt(++u),r=e+n+o,i+=f.charAt(r>>18&63)+f.charAt(r>>12&63)+f.charAt(r>>6&63)+f.charAt(63&r);return 2==a?(e=t.charCodeAt(u)<<8,n=t.charCodeAt(++u),r=e+n,i+=f.charAt(r>>10)+f.charAt(r>>4&63)+f.charAt(r<<2&63)+"="):1==a&&(r=t.charCodeAt(u),i+=f.charAt(r>>2)+f.charAt(r<<4&63)+"=="),i},g={encode:h,decode:y,version:"0.1.0"};if("object"==a(n(2))&&n(2))void 0!==(r=function(){return g}.call(e,n,e,t))&&(t.exports=r);else if(u&&!u.nodeType)if(c)c.exports=g;else for(var m in g)g.hasOwnProperty(m)&&(u[m]=g[m]);else i.base64=g}(void 0)}).call(e,n(5)(t),n(6))},function(t,e,n){"use strict";t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e,n){"use strict";var o,r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};o=function(){return this}();try{o=o||Function("return this")()||(0,eval)("this")}catch(t){"object"===("undefined"==typeof window?"undefined":r(window))&&(o=window)}t.exports=o},function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}function r(t,e){var n={};for(var o in t)e.indexOf(o)>=0||Object.prototype.hasOwnProperty.call(t,o)&&(n[o]=t[o]);return n}function a(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function u(){return m||(m=new g(p.default)),m}Object.defineProperty(e,"__esModule",{value:!0});var c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},l=n(8),d=o(l),f=n(0),p=o(f),y=n(3),h=o(y),g=function t(e){var n=this;i(this,t),this.reset={deleted:void 0,updated:void 0,created:void 0},this.encodeGetUrl=function(t){var e=t.params,o=e.url,r=e.select,a=e.filter,i=e.populate,u=e.sort,c=e.query,s=t.pagination;s=void 0===s?{}:s;var l=s.itemsPerPage,d=void 0===l?null:l,f=s.currentIndex,p=void 0===f?null:f,y=o;return(r||a||i||u||p||d)&&(y=o+"?q"),r&&(y+=n.encode("select",r)),a&&(y+=n.encode("filter",a)),i&&(y+=n.encode("populate",i)),u&&(y+=n.encode("sort",u)),p&&(y+=n.encode("currentIndex",p)),d&&(y+=n.encode("itemsPerPage",d)),c&&(y+=c),y},this.init=function(t){var e=t.data,n=t.url,o=t.filter,r=t.select,a=t.populate,i=t.sort,u=t.itemsPerPage;return{loading:!1,error:!1,data:e||{},params:{url:n,filter:o,select:r,populate:a,sort:i},pagination:{currentIndex:1,itemsPerPage:u||25,totalPages:0,totalItems:0}}},this.setParams=function(t,e){return{data:e.data||t.data,params:s({},t.params,e),pagination:s({},t.pagination,e)}},this.encode=function(t,e){return"&"+t+"="+encodeURIComponent(JSON.stringify(e))},this.get=function(t,e){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,c=n.setParams(t.state[e],i),l=c.data,d=c.params,f=c.pagination,p={params:s({},d)};t.setState(a({},e,s({},n.reset,{params:d,data:l,pagination:f,loading:!0,error:!1}))),o?p.params.url=d.url+"/"+o:p.pagination=f,h.default.get(n.encodeGetUrl(p)).then(function(n){var o=n.data,i=r(n,["data"]);u&&u(o),t.setState(a({},e,s({},t.state[e],{loading:!1,data:o,pagination:i})))},function(n){t.setState(a({},e,s({},t.state[e],{loading:!1,error:n.message,data:l})))})},this.post=function(t,e,o){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=t.state[e].params.url;if(!i)throw new Error("Api.post need params.url on state object");t.setState(a({},e,s({},t.state[e],n.reset,{loading:!0,error:!1}))),h.default.post(i,o).then(function(n){var i=t.state[e].data;r&&(i=s({},i,n.data,o)),t.setState(a({},e,s({},t.state[e],{loading:!1,created:n.data._id,data:i})))},function(n){t.setState(a({},e,s({},t.state[e],{loading:!1,error:n.message})))})},this.put=function(t,e,o){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];t.setState(a({},e,s({},t.state[e],n.reset,{loading:!0,error:!1})));var i=o._id?t.state[e].params.url+"/"+o._id:t.state[e].params.url;h.default.put(i,o).then(function(n){var i=t.state[e].data;r&&(i=s({},i,n.data,o)),t.setState(a({},e,s({},t.state[e],{loading:!1,updated:!0,data:i})))},function(n){t.setState(a({},e,s({},t.state[e],{loading:!1,error:n.message})))})},this.delete=function(t,e,o){t.setState(a({},e,s({},t.state[e],n.reset,{loading:!0,error:!1})));var r=t.state[e].params.url;"string"==typeof o?r=r+"/"+o:"object"==(void 0===o?"undefined":c(o))&&(r=o._id?r+"/"+o._id:r+"?"+d.default.stringify(o)),h.default.delete(r).then(function(n){var o=s({},t.state[e].data,n.data);t.setState(a({},e,s({},t.state[e],{loading:!1,deleted:!0,data:o})))},function(n){t.setState(a({},e,s({},t.state[e],{loading:!1,error:n.message})))})},this.autocomplete=function(t,e,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=t.state[e].params.url+"?";r+=Object.keys(n).map(function(t){return encodeURIComponent(t)+"="+encodeURIComponent(JSON.stringify(n[t]))}).join("&"),h.default.get(r).then(function(n){t.setState(a({},e,s({},t.state[e],{data:n.data}))),o&&n.data.length>0?o(n.data[0]):o&&o({})},function(n){t.setState(a({},e,s({},t.state[e],{data:[]})))})},this.Requester=new h.default.Instance(e)},m=null;e.default={Instance:g,init:u().init,setParams:u().setParams,get:u().get,post:u().post,put:u().put,delete:u().delete,autocomplete:u().autocomplete}},function(t,e,n){"use strict";e.decode=e.parse=n(9),e.encode=e.stringify=n(10)},function(t,e,n){"use strict";function o(t,e){return Object.prototype.hasOwnProperty.call(t,e)}t.exports=function(t,e,n,a){e=e||"&",n=n||"=";var i={};if("string"!=typeof t||0===t.length)return i;var u=/\+/g;t=t.split(e);var c=1e3;a&&"number"==typeof a.maxKeys&&(c=a.maxKeys);var s=t.length;c>0&&s>c&&(s=c);for(var l=0;l<s;++l){var d,f,p,y,h=t[l].replace(u,"%20"),g=h.indexOf(n);g>=0?(d=h.substr(0,g),f=h.substr(g+1)):(d=h,f=""),p=decodeURIComponent(d),y=decodeURIComponent(f),o(i,p)?r(i[p])?i[p].push(y):i[p]=[i[p],y]:i[p]=y}return i};var r=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}},function(t,e,n){"use strict";function o(t,e){if(t.map)return t.map(e);for(var n=[],o=0;o<t.length;o++)n.push(e(t[o],o));return n}var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a=function(t){switch(void 0===t?"undefined":r(t)){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}};t.exports=function(t,e,n,c){return e=e||"&",n=n||"=",null===t&&(t=void 0),"object"===(void 0===t?"undefined":r(t))?o(u(t),function(r){var u=encodeURIComponent(a(r))+n;return i(t[r])?o(t[r],function(t){return u+encodeURIComponent(a(t))}).join(e):u+encodeURIComponent(a(t[r]))}).join(e):c?encodeURIComponent(a(c))+n+encodeURIComponent(a(t)):""};var i=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},u=Object.keys||function(t){var e=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.push(n);return e}}])});